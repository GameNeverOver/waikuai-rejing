"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const constants_1 = require("../utils/constants");
const utils_1 = require("../utils");
const babel_core_1 = require("babel-core");
const loader_utils_1 = require("loader-utils");
function fileParseLoader(source) {
    const { babel: babelConfig, buildAdapter } = loader_utils_1.getOptions(this);
    // console.log('##babelConfig', babelConfig)
    const filePath = this.resourcePath;
    const res = babel_core_1.transform(source, babelConfig); // use config babelConfig
    if (constants_1.NODE_MODULES_REG.test(filePath) && res.code) {
        res.code = utils_1.npmCodeHack(filePath, res.code, buildAdapter);
    }
    return res.code;
}
exports.default = fileParseLoader;
